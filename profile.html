<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBzvVpMCdg3Y6i5vCGWarorcTmzBzjmPow",
    authDomain: "tableforge-app.firebaseapp.com",
    projectId: "tableforge-app",
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  function loginOrSignup() {
    const displayName = document.getElementById("displayName").value.trim();
    const password = document.getElementById("password").value;
    const email = `${displayName}@tableforge.app`;
    const message = document.getElementById("message");

    console.log("ðŸ” Attempting login with:", email);

    auth.signInWithEmailAndPassword(email, password)
      .then(() => {
        console.log("âœ… Login successful");
        message.textContent = "Welcome back!";
        setTimeout(() => {
          window.location.href = "/";
        }, 1000);
      })
      .catch((error) => {
        console.warn("âš ï¸ Login failed:", error.code);

        if (error.code === "auth/user-not-found") {
          console.log("âœ¨ Trying to create new user...");
          auth.createUserWithEmailAndPassword(email, password)
            .then(() => {
              console.log("âœ… New user created!");
              message.textContent = "Forge Identity created! Redirecting...";
              setTimeout(() => {
                window.location.href = "/";
              }, 1000);
            })
            .catch((signupError) => {
              console.error("ðŸ”¥ Signup failed:", signupError);
              message.textContent = `Signup failed: ${signupError.message}`;
            });
        } else {
          message.textContent = `Login failed: ${error.message}`;
        }
      });
  }
</script>
